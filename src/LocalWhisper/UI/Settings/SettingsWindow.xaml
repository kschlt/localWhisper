<Window x:Class="LocalWhisper.UI.Settings.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        mc:Ignorable="d"
        Title="LocalWhisper - Einstellungen"
        Width="500"
        Height="600"
        WindowStartupLocation="CenterScreen"
        ResizeMode="NoResize"
        ShowInTaskbar="False"
        Background="White">

    <Grid Margin="20">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Scrollable Content Area -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel>

                <!-- HOTKEY SECTION -->
                <Border BorderBrush="#D1D1D1" BorderThickness="0,0,0,1" Padding="0,0,0,20" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="Hotkey" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Hotkey TextBox (read-only display) -->
                            <TextBox x:Name="HotkeyTextBox"
                                     x:FieldModifier="internal"
                                     Grid.Column="0"
                                     IsReadOnly="True"
                                     Height="30"
                                     VerticalContentAlignment="Center"
                                     Margin="0,0,10,0"
                                     Background="#F3F3F3"/>

                            <!-- Change Button -->
                            <Button x:Name="ChangeHotkeyButton"
                                    Grid.Column="1"
                                    Content="Ä_ndern..."
                                    Width="100"
                                    Height="30"
                                    Background="#0078D4"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Click="ChangeHotkeyButton_Click"/>
                        </Grid>

                        <!-- Warning Text (allows save) -->
                        <TextBlock x:Name="HotkeyWarningText"
                                   x:FieldModifier="internal"
                                   Margin="0,5,0,0"
                                   Foreground="#FFB900"
                                   FontSize="12"
                                   TextWrapping="Wrap"
                                   Visibility="Collapsed"/>

                        <!-- Error Text (blocks save) -->
                        <TextBlock x:Name="HotkeyErrorText"
                                   x:FieldModifier="internal"
                                   Margin="0,5,0,0"
                                   Foreground="#E81123"
                                   FontSize="12"
                                   TextWrapping="Wrap"
                                   Visibility="Collapsed"/>
                    </StackPanel>
                </Border>

                <!-- DATA ROOT SECTION -->
                <Border BorderBrush="#D1D1D1" BorderThickness="0,0,0,1" Padding="0,0,0,20" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="Datenordner / Data Root" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <!-- Data Root TextBox (read-only display) -->
                            <TextBox x:Name="DataRootTextBox"
                                     x:FieldModifier="internal"
                                     Grid.Column="0"
                                     IsReadOnly="True"
                                     Height="30"
                                     VerticalContentAlignment="Center"
                                     Margin="0,0,10,0"
                                     Background="#F3F3F3"/>

                            <!-- Browse Button -->
                            <Button x:Name="BrowseDataRootButton"
                                    Grid.Column="1"
                                    Content="_Durchsuchen"
                                    Width="100"
                                    Height="30"
                                    Background="#0078D4"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Click="BrowseDataRootButton_Click"/>
                        </Grid>

                        <!-- Error Text -->
                        <TextBlock x:Name="DataRootErrorText"
                                   x:FieldModifier="internal"
                                   Margin="0,5,0,0"
                                   Foreground="#E81123"
                                   FontSize="12"
                                   TextWrapping="Wrap"
                                   Visibility="Collapsed"/>
                    </StackPanel>
                </Border>

                <!-- LANGUAGE SECTION -->
                <Border BorderBrush="#D1D1D1" BorderThickness="0,0,0,1" Padding="0,0,0,20" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="Sprache / Language" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>

                        <StackPanel Orientation="Horizontal">
                            <RadioButton x:Name="LanguageGerman"
                                         x:FieldModifier="internal"
                                         Content="Deutsch"
                                         GroupName="Language"
                                         Margin="0,0,20,0"
                                         Checked="LanguageRadioButton_Checked"/>
                            <RadioButton x:Name="LanguageEnglish"
                                         x:FieldModifier="internal"
                                         Content="English"
                                         GroupName="Language"
                                         Checked="LanguageRadioButton_Checked"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- FILE FORMAT SECTION -->
                <Border BorderBrush="#D1D1D1" BorderThickness="0,0,0,1" Padding="0,0,0,20" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="Dateiformat / File Format" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>

                        <StackPanel Orientation="Horizontal">
                            <RadioButton x:Name="FileFormatMarkdown"
                                         x:FieldModifier="internal"
                                         Content="Markdown (.md)"
                                         GroupName="FileFormat"
                                         Margin="0,0,20,0"
                                         Checked="FileFormatRadioButton_Checked"/>
                            <RadioButton x:Name="FileFormatTxt"
                                         x:FieldModifier="internal"
                                         Content="Plain Text (.txt)"
                                         GroupName="FileFormat"
                                         Checked="FileFormatRadioButton_Checked"/>
                        </StackPanel>
                    </StackPanel>
                </Border>

                <!-- MODEL SECTION -->
                <Border BorderBrush="#D1D1D1" BorderThickness="0,0,0,1" Padding="0,0,0,20" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="Whisper Modell" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>

                        <!-- Model Path Display -->
                        <TextBlock x:Name="ModelPathText"
                                   x:FieldModifier="internal"
                                   Text="Pfad: (kein Modell konfiguriert)"
                                   Foreground="#666666"
                                   FontSize="12"
                                   TextWrapping="Wrap"
                                   Margin="0,0,0,10"/>

                        <!-- Buttons -->
                        <StackPanel Orientation="Horizontal">
                            <Button x:Name="VerifyModelButton"
                                    Content="_Prüfen"
                                    Width="100"
                                    Height="30"
                                    Background="#0078D4"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Margin="0,0,10,0"
                                    Click="VerifyModelButton_Click"/>
                            <Button x:Name="ChangeModelButton"
                                    Content="Änd_ern..."
                                    Width="100"
                                    Height="30"
                                    Background="#0078D4"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Click="ChangeModelButton_Click"/>
                        </StackPanel>

                        <!-- Model Status -->
                        <TextBlock x:Name="ModelStatusText"
                                   x:FieldModifier="internal"
                                   Margin="0,10,0,0"
                                   FontSize="12"
                                   TextWrapping="Wrap"
                                   Visibility="Collapsed"/>
                    </StackPanel>
                </Border>

                <!-- POST-PROCESSING SECTION (Iteration 7) -->
                <Border BorderBrush="#D1D1D1" BorderThickness="0,0,0,1" Padding="0,0,0,20" Margin="0,0,0,20">
                    <StackPanel>
                        <TextBlock Text="Post-Processing (KI-basierte Nachbearbeitung)" FontSize="14" FontWeight="Bold" Margin="0,0,0,10"/>

                        <!-- Enable Checkbox -->
                        <CheckBox x:Name="PostProcessingEnabledCheckBox"
                                  Content="Post-Processing aktivieren"
                                  Margin="0,0,0,15"
                                  Checked="PostProcessingEnabledCheckBox_Changed"
                                  Unchecked="PostProcessingEnabledCheckBox_Changed"/>

                        <!-- llama-cli.exe Path -->
                        <TextBlock Text="llama-cli.exe Pfad:" Margin="0,0,0,5"/>
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="LlmCliPathTextBox"
                                     Grid.Column="0"
                                     Height="30"
                                     VerticalContentAlignment="Center"
                                     Margin="0,0,10,0"
                                     TextChanged="SettingsChanged"/>
                            <Button x:Name="BrowseLlmCliButton"
                                    Grid.Column="1"
                                    Content="_Durchsuchen"
                                    Width="100"
                                    Height="30"
                                    Background="#0078D4"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Click="BrowseLlmCliButton_Click"/>
                        </Grid>

                        <!-- Llama Model Path -->
                        <TextBlock Text="Llama Modell Pfad:" Margin="0,0,0,5"/>
                        <Grid Margin="0,0,0,15">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="LlmModelPathTextBox"
                                     Grid.Column="0"
                                     Height="30"
                                     VerticalContentAlignment="Center"
                                     Margin="0,0,10,0"
                                     TextChanged="SettingsChanged"/>
                            <Button x:Name="BrowseLlmModelButton"
                                    Grid.Column="1"
                                    Content="_Durchsuchen"
                                    Width="100"
                                    Height="30"
                                    Background="#0078D4"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Click="BrowseLlmModelButton_Click"/>
                        </Grid>

                        <!-- Glossary Checkbox -->
                        <CheckBox x:Name="UseGlossaryCheckBox"
                                  Content="Glossar verwenden"
                                  Margin="0,0,0,10"
                                  Checked="UseGlossaryCheckBox_Changed"
                                  Unchecked="UseGlossaryCheckBox_Changed"/>

                        <!-- Glossary Path -->
                        <TextBlock x:Name="GlossaryPathLabel" Text="Glossar Pfad:" Margin="0,0,0,5"/>
                        <Grid Margin="0,0,0,0">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>
                            <TextBox x:Name="GlossaryPathTextBox"
                                     Grid.Column="0"
                                     Height="30"
                                     VerticalContentAlignment="Center"
                                     Margin="0,0,10,0"
                                     TextChanged="SettingsChanged"/>
                            <Button x:Name="BrowseGlossaryButton"
                                    Grid.Column="1"
                                    Content="_Durchsuchen"
                                    Width="100"
                                    Height="30"
                                    Background="#0078D4"
                                    Foreground="White"
                                    BorderThickness="0"
                                    Click="BrowseGlossaryButton_Click"/>
                        </Grid>
                    </StackPanel>
                </Border>

            </StackPanel>
        </ScrollViewer>

        <!-- Bottom Bar: Version + Buttons -->
        <Grid Grid.Row="2" Margin="0,20,0,0">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="Auto"/>
            </Grid.ColumnDefinitions>

            <!-- Version Number -->
            <TextBlock x:Name="VersionText"
                       x:FieldModifier="internal"
                       Grid.Column="0"
                       Text="v0.1.0"
                       VerticalAlignment="Center"
                       Foreground="#666666"
                       FontSize="10"/>

            <!-- Cancel Button -->
            <Button x:Name="CancelButton"
                    Grid.Column="2"
                    Content="_Abbrechen"
                    Width="100"
                    Height="35"
                    Background="#E81123"
                    Foreground="White"
                    BorderThickness="0"
                    Margin="0,0,10,0"
                    Click="CancelButton_Click"/>

            <!-- Save Button -->
            <Button x:Name="SaveButton"
                    x:FieldModifier="internal"
                    Grid.Column="3"
                    Content="_Speichern"
                    Width="100"
                    Height="35"
                    Background="#0078D4"
                    Foreground="White"
                    BorderThickness="0"
                    IsEnabled="False"
                    Click="SaveButton_Click"/>
        </Grid>
    </Grid>
</Window>
