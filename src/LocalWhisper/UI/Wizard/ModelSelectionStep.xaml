<UserControl x:Class="LocalWhisper.UI.Wizard.ModelSelectionStep"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             Background="White">

    <ScrollViewer VerticalScrollBarVisibility="Auto">
        <StackPanel Margin="40,30">
            <TextBlock Text="Whisper-Modell auswählen"
                      FontSize="16"
                      FontWeight="SemiBold"
                      Margin="0,0,0,10"/>

            <TextBlock Text="Wählen Sie die Sprache und das Modell für die Spracherkennung:"
                      TextWrapping="Wrap"
                      Margin="0,0,0,20"
                      Foreground="#666666"/>

            <!-- Language Selection -->
            <Label Content="Sprache:" Margin="0,0,0,5"/>
            <ComboBox x:Name="LanguageComboBox"
                     Padding="8"
                     Margin="0,0,0,20"
                     SelectionChanged="LanguageComboBox_SelectionChanged">
                <ComboBoxItem Content="German / Deutsch" Tag="de" IsSelected="True"/>
                <ComboBoxItem Content="English" Tag="en"/>
            </ComboBox>

            <!-- Model Selection -->
            <Label Content="Modell:" Margin="0,0,0,5"/>
            <DataGrid x:Name="ModelGrid"
                     AutoGenerateColumns="False"
                     IsReadOnly="True"
                     SelectionMode="Single"
                     HeadersVisibility="Column"
                     GridLinesVisibility="Horizontal"
                     RowBackground="White"
                     AlternatingRowBackground="#F9F9F9"
                     Margin="0,0,0,15"
                     Height="180"
                     SelectionChanged="ModelGrid_SelectionChanged">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Modell" Binding="{Binding Name}" Width="100"/>
                    <DataGridTextColumn Header="Größe" Binding="{Binding SizeMB, StringFormat={}{0} MB}" Width="80"/>
                    <DataGridTextColumn Header="Geschwindigkeit" Binding="{Binding SpeedFactor, StringFormat={}~{0}x}" Width="120"/>
                    <DataGridTextColumn Header="Beschreibung" Binding="{Binding Description}" Width="*"/>
                </DataGrid.Columns>
            </DataGrid>

            <!-- File Selection -->
            <Border BorderBrush="#E0E0E0" BorderThickness="1" Background="#F5F5F5" Padding="15" Margin="0,0,0,15">
                <StackPanel>
                    <TextBlock Text="Modell-Datei auswählen" FontWeight="SemiBold" Margin="0,0,0,10"/>
                    <TextBlock TextWrapping="Wrap" Foreground="#666666" Margin="0,0,0,10">
                        Bitte laden Sie das ausgewählte Modell von <Hyperlink NavigateUri="https://huggingface.co/ggerganov/whisper.cpp/tree/main" RequestNavigate="Hyperlink_RequestNavigate">HuggingFace</Hyperlink> herunter und wählen Sie die .bin-Datei aus.
                    </TextBlock>

                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>

                        <TextBox x:Name="ModelFileTextBox"
                                Grid.Column="0"
                                IsReadOnly="True"
                                Padding="8"
                                VerticalContentAlignment="Center"
                                Background="White"
                                Text="Keine Datei ausgewählt"/>

                        <Button x:Name="BrowseModelButton"
                               Grid.Column="1"
                               Content="Datei wählen..."
                               Padding="15,8"
                               Margin="10,0,0,0"
                               Click="BrowseModelButton_Click"
                               IsEnabled="False"/>
                    </Grid>
                </StackPanel>
            </Border>

            <!-- Validation Status -->
            <StackPanel x:Name="ValidationPanel" Visibility="Collapsed" Margin="0,0,0,15">
                <ProgressBar x:Name="ValidationProgress"
                            Height="4"
                            IsIndeterminate="True"
                            Margin="0,0,0,10"/>

                <TextBlock x:Name="ValidationStatus"
                          Text="Berechne Hash..."
                          Foreground="#FF9800"
                          FontWeight="SemiBold"/>
            </StackPanel>

            <TextBlock x:Name="ValidationResult"
                      Visibility="Collapsed"
                      FontWeight="SemiBold"
                      Margin="0,0,0,15"/>
        </StackPanel>
    </ScrollViewer>
</UserControl>
